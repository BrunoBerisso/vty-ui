\section{Lists}
\label{sec:lists}

The \fw{List} module provides a rich interface for displaying,
navigating, and selecting from a list of elements.

\fw{List}s support the following key bindings:

\begin{itemize}
\item \fw{Up}, \fw{Down} -- changes the currently-selected element by
  one element in the respective direction.
\item \fw{PageUp}, \fw{PageDown} -- changes the currently-selected
  element by a page of elements, which depends on the number of
  elements currently shown in the list.
\item \fw{Enter} -- notifies event handlers that the
  currently-selected item has been ``activated.''
\end{itemize}

Lists are implemented with the type \fw{List a b}.  This type's two
parameters are as follows:

\begin{itemize}
\item \textit{internal item type}, \fw{a} -- This is the type of the
  application-specific value stored in each list item.  This is the
  data that is represented by the visual aspect of the list element,
  and it will not necessarily have anything to do with the visual
  representation.
\item \textit{item widget type}, \fw{b} -- This is the type of the
  widget state of each element as it is represented in the interface.
  For example, a simple list of strings might use \fw{String} as its
  internal value and \fw{Widget FormattedText} (Section
  \ref{sec:text}) as its widget type, resulting in a list of type
  \fw{List String FormattedText}.
\end{itemize}

Lists are created with the \fw{newList} function:

\begin{haskellcode}
 lst <- newList attr plainText
\end{haskellcode}

\fw{newList} takes two parameters: the attribute of the
currently-selected item to be used when the list is \textit{not}
focused, and the \textit{constructor function} to be used to create
widgets when new items are added to the list.  The \fw{List} uses its
own focus attribute (Section \ref{sec:attributes}) as the attribute of
the currently-selected item when it has the focus.

Items may be added to a \fw{List} with the \fw{addToList} function,
which takes an internal item value (e.g., \fw{String}) and uses it to
construct a widget with the appropriate type (e.g. \fw{Widget
  FormattedText}):

\begin{haskellcode}
 addToList lst "foobar"
\end{haskellcode}

The constructor function passed to \fw{newList} can be thought of as a
specification of how list items should be represented.  For a \fw{List
  a b}, it must take a value of type \fw{a} and return a \fw{Widget
  b}.  There are two restrictions on what the constructor can return:

\begin{itemize}
\item The \fw{Widget b} type \textit{must not grow vertically}.  This
  is because all \fw{List} item widgets must take up a fixed amount of
  vertical space so the \fw{List} can manage scrolling, for example.
  If the widget grows vertically, \fw{addToList} will throw a
  \fw{ListError} exception.
\item All widgets returned \textit{must have the same height}.  This
  is because the list uses the item height to calculate how many items
  can be displayed, given the space available to the rendered
  \fw{List}.  If the constructor creates a widget whose doesn't match
  that of the rest of the wigets of the list, layout problems are
  likely to ensue.
\end{itemize}

Conversely, items may be removed from \fw{List}s with the
\fw{removeFromList} function, which takes a \fw{Widget (List a b)} and
an item position, removes the item at the specified position, and
returns the removed item:

\begin{haskellcode}
 (val, w) <- removeFromList lst 0
\end{haskellcode}

If the position is invalid, a \fw{ListError} is thrown.
\fw{removeFromList} returns the internal value (\fw{val}) and the
corresponding widget (\fw{w}) of the removed list entry.

All of the items can be removed with the \fw{clearList} function.
Note that \fw{clearList} does \textit{not} invoke any event handlers
for the removed items.

\subsection{\fw{List} Inspection}

The \fw{List} module provides some functions to get information about
the state of a \fw{List}:

\begin{itemize}
\item \fw{getListSize} -- returns the number of elements in a
  \fw{List}.
\item \fw{getSelected} -- takes a \fw{Widget (List a b)} and returns
  \fw{Nothing} if the \fw{List} is empty or returns \fw{Just (pos,
    (val, widget))} corresponding to the list index, internal item
  value, and widget of the currently-selected list item.
\end{itemize}

\subsection{Scrolling a \fw{List}}
\label{sec:list_scrolling}

Although the list key bindings are bound to the \fw{List}'s scrolling
behavior, the \fw{List} module exports the scrolling functions for
programmatic manipulation of \fw{List}s.  Note that in all cases, the
scrolling functions change the position of the currently-selected item
and, if necessary, scroll the list in the terminal to reveal the
newly-selected item.

\begin{itemize}
\item \fw{scrollUp} -- moves the selected item position toward the
  beginning of the \fw{List} by one position.
\item \fw{scrollDown} -- moves the selected item position toward the
  end of the \fw{List} by one position.
\item \fw{pageUp} -- moves the selected item position toward the
  beginning of the \fw{List} by one page; the size of a page depends
  on the height of the \fw{List}'s widgets and the amount of space
  available to the rendered \fw{List}.
\item \fw{pageDown} -- moves the selected item position toward the end
  of the \fw{List} by one page; the size of a page depends on the
  height of the \fw{List}'s widgets and the amount of space available
  to the rendered \fw{List}.
\item \fw{scrollBy} -- takes a number of positions and moves the
  selected item position in the specified direction.  If the number is
  negative, this scrolls toward the beginning of the \fw{List},
  otherwise, it scrolls toward the end.
\end{itemize}

\subsection{Handling Events}

The \fw{List} type produces a variety of events:

\begin{itemize}
\item \textit{scrolling events} -- events indicating that the position
  of the currently-selected item has changed.  Handlers are registered
  with \fw{onSelectionChange} and receive an event value of type
  \fw{SelectionEvent}.  A \fw{SelectionEvent} describes whether the
  selection has been turned ``off'', which happens when the last
  element in the \fw{List} is removed, or whether it is on and
  corresponds to an item.
\item \textit{item events} -- events indicating that an item has been
  added to or removed from the \fw{List}.  Handlers for added items
  are registered with \fw{onitemAdded} receive event values of type
  \fw{NewItemEvent}.  Handlers for removed items are registered with
  \fw{onItemRemoved} and receive event values of type
  \fw{RemoveItemEvent}.
\item \textit{item activation} -- events indicating that the
  currently-selected item was \textit{activated}, which occurs when
  the user presses \fw{Enter} on a focused \fw{List}.  Handlers for
  activation events are registered with \fw{onItemActivated} and
  receive event values of type \fw{ActivateItemEvent}.
\end{itemize}

Scrolling events are generated by the functions described in Section
\ref{sec:list_scrolling}.  Item activation may be triggered
programmatically with the \fw{activateCurrentItem} function.

\subsubsection{Growth Policy}

\fw{List}s always grow both horizontally and vertically.
